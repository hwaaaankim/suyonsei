<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/admin/common :: adminHead('관리자페이지')">

</head>

<body>
    <section id="container">

       <th:block th:replace="fragments/admin/common :: adminHeader"></th:block>

        <th:block th:replace="fragments/admin/common :: adminSidebar"></th:block>
        <section id="main-content">
            <section class="wrapper">
                <div class="row mt">
                    <div class="col-md-12">
                        <div class="content-panel">
                            <h4>
                                <i class="fa fa-angle-right"></i> 문의 : 총 <span></span>건
                            </h4>
                            <hr>
                            <div class="row search-section">
                                <div class="col-md-12">
                                    <h6>
                                        <i class="fas fa-question-circle"></i> 기본 검색조건 설정
                                    </h6>
                                    <form class="form-inline" role="form" method="GET" th:action="@{/admin/clientManager}">
                                        <div class="form-group">
											<select class="form-control" th:name="size" id="pageSize">
												<option th:value="10" th:selected="${clients.pageable.pageSize}=='10'">10개씩 보기</option>
												<option th:value="30" th:selected="${clients.pageable.pageSize}=='30'">30개씩 보기</option>
												<option th:value="50" th:selected="${clients.pageable.pageSize}=='50'">50개씩 보기</option>
												<option th:value="100" th:selected="${clients.pageable.pageSize}=='100'">100개씩 보기</option>
											</select>
										</div>
                                        <div class="form-group">
                                            <select class="form-control" name="searchType" id="searchType">
                                                <option id="searchBasic" value="">검색 조건 선택</option>
                                                <option th:selected="${searchType == 'name'}" id="searchName"
                                                    th:value="name">고객명 검색</option>
                                                <option th:selected="${searchType == 'phone'}" id="searchPhone"
                                                    th:value="phone">고객 연락처 검색</option>
                                                <option th:selected="${searchType == 'email'}" id="searchEmail"
                                                    th:value="email">고객 이메일 검색</option>
                                                <option th:selected="${searchType == 'period'}" id="searchPeriod"
                                                    th:value="period">기간 별 검색</option>
                                                <option th:selected="${searchType == 'subject'}" id="searchSubject"
                                                    th:value="subject">주제 별 검색</option>   
                                            </select>
                                        </div>
                                        <div class="form-group" id="textSearch">
                                            <input type="text" class="form-control" name="searchWord"
                                                th:value="${param.searchWord}" placeholder="검색어 입력">
                                        </div>
                                        <div class="form-group" id="periodSearch">
                                            <input type="date" class="form-control" id="startDate" name="startDate"
                                                th:value="${param.startDate}">
                                            <input type="date" class="form-control" id="endDate" name="endDate"
                                                th:value="${param.endDate}">
                                             <p style="position:absolute;"># 해당 기간에 문의를 제출한 고객을 검색합니다.</p>
                                        </div>
                                        <div class="form-group" id="subjectSearch">
                                       		 <select class="form-control" name="subjectText">
                                                <option th:selected="${subjectText == '원추각막'}" id="searchName"
                                                    th:value="원추각막">원추각막</option>
                                                <option th:selected="${subjectText == '스마일라식'}" id="searchPhone"
                                                    th:value="스마일라식">스마일라식</option>
                                                <option th:selected="${subjectText == '렌즈삽입'}" id="searchEmail"
                                                    th:value="렌즈삽입">렌즈삽입</option>
                                                <option th:selected="${subjectText == '라섹'}" id="searchPeriod"
                                                    th:value="라섹">라섹</option>
                                                <option th:selected="${subjectText == '라식'}" id="searchSubject"
                                                    th:value="라식">라식</option>   
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-theme">검색하기</button>
                                    </form>
                                </div>
                            </div>
                            <table class="table table-striped table-advance table-hover">
                                <hr>
                                <thead>
                                    <tr>
                                        <th class="hidden-phone"><i class="fa-solid fa-hashtag"></i> 번호</th>
                                        <th><i class="fa-solid fa-signature"></i> 이름</th>
                                        <th><i class="fa-solid fa-phone"></i> 연락처</th>
                                        <th><i class="fa-solid fa-globe"></i> 신청국가</th>
                                        <th class="hidden-phone"><i class="fa-solid fa-check"></i> 체크여부</th>
                                        <th class="hidden-phone"><i class=" fa fa-edit"></i> 비고</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="clients:${clients}">
                                        <td class="hidden-phone" th:text="${clients.id}">
                                            
                                        </td>
                                        <!--<td><a href="/admin/clientDetail"
                                          th:text="${clients.name}"
                                          th:href="@{|/admin/clientDetail/${clients.id}|}">고객이름</a></td>-->
                                        <td><a href="/admin/clientDetail"
                                          th:text="${clients.name}"
                                          th:href="@{|/admin/clientDetail/${clients.id}|}">고객이름</a></td> 
                                        <td><a th:href="|tel:,${clients.phone}|" th:text="${clients.phone}">010-1234-1234</a> </td>
                                        <td th:if="${clients.code == 'en'}">영문 사이트 신청</td>
                                        <td th:if="${clients.code == 'jp'}">일본 사이트 신청</td>
                                        <td th:if="${clients.sign == true}" style="color:green; font-weight:600;">확인</td>
                                        <td th:if="${clients.sign == false}" style="color:red; font-weight:600;">미확인</td>
										<td class="hidden-phone">
											<button th:if="${clients.sign == false}" th:onclick="|clientDelete('${clients.id}')|" class="btn btn-success btn-xs"><i class="fa fa-check"></i></button>
											<button th:if="${clients.sign == true}" th:onclick="|clientDelete('${clients.id}')|" class="btn btn-success btn-xs" disabled><i class="fa fa-check"></i></button>
                                            <button th:onclick="|location.href='@{/admin/clientDetail/{id}(id=${clients.id})}'|" class="btn btn-primary btn-xs"><i class="fa fa-pencil"></i></button>
                                            <button th:onclick="|clientDelete('${clients.id}')|" class="btn btn-danger btn-xs"><i class="fa fa-trash-o "></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="text-align:center;">
                            <nav aria-label="navigation" style="text-align: center;">
								<ul class="pagination justify-content-center">
									<li class="page-item"
										th:classappend="${1 == clients.pageable.pageNumber+1} ? 'disabled'">
										<a class="page-link" href="#"
										th:href="@{/admin/clientManager(page=0, size=${param.size}, searchType=${param.searchType}, searchWord=${param.searchWord}, startDate=${param.startDate}
										,endDate=${param.endDate})}"
										tabindex="-1" aria-disabled="true">First</a>
									</li>
									<li class="page-item"
										th:classappend="${1 == clients.pageable.pageNumber+1} ? 'disabled'">
										<a class="page-link" href="#"
										th:href="@{/admin/clientManager(page=${clients.pageable.pageNumber - 1}, size=${param.size}, searchType=${param.searchType}, searchWord=${param.searchWord}, startDate=${param.startDate}
										,endDate=${param.endDate})}"
										tabindex="-1" aria-disabled="true">Previous</a>
									</li>
									<li class="page-item"
										th:classappend="${i == clients.pageable.pageNumber+1} ? 'disabled'"
										th:each="i : ${#numbers.sequence(startPage, endPage)}">
										<a	class="page-link" href="#" th:text=${i}
										th:href="@{/admin/clientManager(page=${i-1}, size=${param.size}, searchType=${param.searchType}, searchWord=${param.searchWord}, startDate=${param.startDate}
										,endDate=${param.endDate})}">1</a>
									</li>
									<li class="page-item"
										th:classappend="${clients.totalPages == clients.pageable.pageNumber + 1} ? 'disabled'">
										<a class="page-link" href="#"
										th:href="@{/admin/clientManager(page=${clients.pageable.pageNumber + 1}, size=${param.size}, searchType=${param.searchType}, searchWord=${param.searchWord}, startDate=${param.startDate}
										,endDate=${param.endDate})}">Next</a>
									</li>
									<li class="page-item"
										th:classappend="${clients.totalPages == clients.pageable.pageNumber + 1} ? 'disabled'">
										<a class="page-link" href="#"
										th:href="@{/admin/clientManager(page=${clients.totalPages-1}, size=${param.size}, searchType=${param.searchType}, searchWord=${param.searchWord}, startDate=${param.startDate}
										,endDate=${param.endDate})}">Last</a>
									</li>
								</ul>
							</nav>
                        </div>
                    </div>
                </div>
            </section>
        </section>
    </section>
    <th:block th:replace="fragments/admin/common :: adminScript"></th:block>
    <script src="/administration/assets/lib/search.js" type="text/javascript"></script>
    <script th:inline="javascript">
   		var searchType = /*[[${searchType}]]*/ 'default';
    </script>
    <script>
		function clientDelete(id){
			var result = confirm('해당 고객을 삭제 하시겠습니까?');
			if(result){
				location.href="/admin/clientDelete/" + id;
			}
		}
		
		function changeSign(id){
			var result = confirm('해당 고객의 상태를 확인완료 상태로 변경하시겠습니까?');
			if(result){
				location.href="/admin/changeSign/" + id;
			}
		}
	</script>
</body>

</html>